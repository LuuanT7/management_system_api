datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

enum Shift {
  MORNING
  AFTERNOON
}

enum ActivityType {
  HOMEWORK
  TEST
  PROJECT
  QUIZ
  EXAM
}

model Teacher {
  id       String   @id @default(uuid())
  name     String
  email    String   @unique
  classes  Class[]
}

model Class {
  id          String      @id @default(uuid())
  name        String
  createdAt   DateTime    @default(now())
  subject     String
  shift       Shift
  startTime   String
  endTime     String
  teacherId   String
  teacher     Teacher     @relation(fields: [teacherId], references: [id])
  enrollments Enrollment[]
  activities  Activity[]
}

model Student {
  id         String       @id @default(uuid())
  name       String
  email      String       @unique
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
  enrollments Enrollment[]
  grades     Grade[]
}

model Enrollment {
  id         String   @id @default(uuid())
  studentId  String
  classId    String
  createdAt  DateTime @default(now()) // ðŸ‘ˆ adicionado

  student    Student  @relation(fields: [studentId], references: [id])
  class      Class    @relation(fields: [classId], references: [id])

  @@unique([studentId, classId])
}

model Activity {
  id          String      @id @default(uuid())
  title       String
  description String?
  dueDate     DateTime
  maxScore    Float
  weight      Float?      @default(1)
  type        ActivityType
  teacherId   String
  classId     String

  class       Class       @relation(fields: [classId], references: [id])
  grades      Grade[]

  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
}

model Grade {
  id         String     @id @default(uuid())
  studentId  String
  activityId String
  score      Float

  student    Student    @relation(fields: [studentId], references: [id])
  activity   Activity   @relation(fields: [activityId], references: [id])

  @@unique([studentId, activityId])
}
